---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';

type Props = CollectionEntry<'blog'>['data'] & {
	/** Make the content container wider (useful for wide pages like About). */
	wide?: boolean;
	/** Use accent color for the title/date area. */
	accentTitle?: boolean;
	/** Hide the date block (useful for non-blog pages like About). */
	showDate?: boolean;
};

const {
	title,
	description = '',
	pubDate,
	updatedDate,
	wide,
	accentTitle,
	showDate = true,
} = Astro.props as Props;
---

<html lang="en">
	<head>
		<BaseHead title={title} description={description} />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous" />
		<style>
			main {
				width: calc(100% - 2em);
				max-width: 100%;
				margin: 0;
			}
			.hero-image {
				width: 100%;
			}

			.prose {
				width: 720px;
				max-width: calc(100% - 2em);
				margin: auto;
				padding: 1em;
				color: rgb(var(--gray-dark));
			}
			.prose.wide {
				width: 980px;
			}
			@media (min-width: 1200px) {
				.prose.wide {
					width: 1080px;
				}
			}
			.title {
				margin-bottom: 1em;
				padding: 1em 0;
				text-align: center;
				line-height: 1;
			}
			.title.accent {
				color: var(--accent);
			}
			.title.accent h1 {
				color: var(--accent);
				font-size: 2.4em;
			}
			.title.accent .date {
				color: var(--accent-dark);
			}
			.title.accent hr {
				border-top-color: rgba(201, 43, 0, 0.25);
			}
			.title h1 {
				margin: 0 0 0.5em 0;
				color: var(--accent);
				font-size: 2.4em;
			}
			.date {
				margin-bottom: 0.5em;
				color: rgb(var(--gray));
			}
			.last-updated-on {
				font-style: italic;
			}

			/* Markdown / rich-text headings inside the slot */
			:global(.prose h1),
			:global(.prose h2),
			:global(.prose h3),
			:global(.prose h4),
			:global(.prose h5),
			:global(.prose h6) {
				color: var(--accent);
			}
			:global(.prose h1) {
				font-size: 2.2em;
			}
			:global(.prose h2) {
				font-size: 1.8em;
			}
			:global(.prose h3) {
				font-size: 1.45em;
			}
			:global(.prose h4) {
				font-size: 1.2em;
			}
			:global(.prose h5) {
				font-size: 1.05em;
			}
			:global(.prose h6) {
				font-size: 1em;
			}
		</style>
	</head>

	<body>
		<Header />
		<main>
			<article>
				<div class:list={['prose', wide && 'wide']}>
					<div class:list={['title', accentTitle && 'accent']}>
						{
							showDate && pubDate && (
								<div class="date">
									<FormattedDate date={pubDate} />
									{
										updatedDate && (
											<div class="last-updated-on">
												Last updated on <FormattedDate date={updatedDate} />
											</div>
										)
									}
								</div>
							)
						}
						<h1>{title}</h1>
						<hr />
					</div>
					<slot />
				</div>
			</article>
		</main>
		<Footer />
	</body>
</html>
